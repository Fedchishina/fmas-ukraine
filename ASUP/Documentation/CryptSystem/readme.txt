Автор: Кропов Валентин
Дата: 29.03.2005, исправлено: 10.06.2005
связь: valik@buhg.dongu.donetsk.ua / ICQ: 194484604

Настройка БД.
~~~~~~~~~~~~

Настройка списка систем производится автоматически при выполнении скрипта "скрипт формирования списка систем.sql"

Настройка выпадающего списка типов обновления (списка систем).
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Дабы облегчить жизнь разработчикам в настроечном файле "CryptSystem.ini" в секции "[CryptSystemItems]" хранится список типов обновлений (систем) в виде списка в формате:

<Индекс списка>=<наименование типа обновления>;<идентификатор типа обновления>

Например:

[CryptSystemItems]
0=Управление персоналом (обновление ПО, всем);1
1=ФПОП (обновление ПО, всем);2
2=УАДО (обновление ПО, всем);3
3=Скрипты из ГПП (всем);4
4=Управление персоналом (промежуточные скрипты, всем);10
5=ФПОП (промежуточные скрипты, всем);20
6=УАДО (промежуточные скрипты, всем);30


Пример настроечного файла прилагается.


Создание скрипта обновления.
~~~~~~~~~~~~~~~~~~~~~~~~~~~

Для того чтобы создать скрипт обновления необходимо:

1. Создать единый скрипт.

2. Запустить CryptSystem.exe, выбрать файл, выбрать тип обновления (систему) из списка, ввести № обновления (если это первое обновление, то нужно поставить 1 и т.д.), ввести дату обновления и нажать кнопку "Сгенерировать файл обновления". Полученый файл будет зашифрован и расшифровать и применить его к БД можно будет только при помощи утилиты UpdateSystem.exe, которая будет передана всем подразделениям. Утилита CryptSystem.exe предназначена только для разработчиков!

Защита ПО от несовместимости БД и исполняемых файлов.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Чтобы не допустить возможность работы на старых исполняемых файлах с новой БД или наоборот необходимо при старте своего ПО вызвать хранимую процедуру 
SYS_VERSION_HISTORY_MAX_UPDATE(:id_system), где :id_system - идентификатор вашей системы. При этом вернется номер последнего установленного обновления в БД. В исполняемом файле необходимо хранить его версию и при запуске проверять совпадает ли версия исполняемого файла с номером последнего установленного обновления, если не совпадает - необходимо отобразить сообщение об ошибке и завершать приложение.